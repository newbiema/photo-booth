<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Photo Booth</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --accent: #FFE66D;
            --dark: #1A535C;
            --light: #F7FFF7;
            --frame: #FF6B6B;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'VT323', monospace;
            background: linear-gradient(135deg, #1A535C, #1e6d76);
            color: #F7FFF7;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 230, 109, 0.1) 0px, transparent 5px),
                radial-gradient(circle at 90% 80%, rgba(78, 205, 196, 0.1) 0px, transparent 5px);
            background-size: 30px 30px;
            image-rendering: pixelated;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            position: relative;
            margin-bottom: 10px;
            z-index: 10;
        }
        
        h1 {
            font-family: 'Press Start 2P', cursive;
            font-size: 2.8rem;
            margin-bottom: 15px;
            color: var(--accent);
            text-shadow: 5px 5px 0 var(--dark);
            letter-spacing: 2px;
        }
        
        .subtitle {
            font-size: 1.8rem;
            color: var(--accent);
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.4;
            text-shadow: 3px 3px 0 var(--dark);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: rgba(26, 83, 92, 0.8);
            border-radius: 0;
            padding: 25px;
            display: flex;
            flex-direction: column;
            border: 4px solid var(--accent);
            box-shadow: 8px 8px 0 rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: repeating-linear-gradient(
                45deg,
                var(--primary),
                var(--primary) 10px,
                var(--secondary) 10px,
                var(--secondary) 20px
            );
        }
        
        .panel-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            color: var(--accent);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 3px 3px 0 var(--dark);
        }
        
        .camera-container {
            position: relative;
            border-radius: 0;
            overflow: hidden;
            aspect-ratio: 16/9;
            background: linear-gradient(45deg, #0a2e33, #0d3d44);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            border: 4px solid var(--accent);
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        video {
            transform: scaleX(-1);
            width: 100%;
            height: 100%;
            object-fit: cover;
            image-rendering: pixelated;
        }
        
        #countdown {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 107, 107, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 120px;
            color: white;
            font-weight: bold;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s;
            font-family: 'Press Start 2P', cursive;
            text-shadow: 5px 5px 0 rgba(0, 0, 0, 0.3);
        }
        
        #countdown.active {
            opacity: 1;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 600px) {
            .controls-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .control-label {
            font-size: 1.4rem;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .number-control {
            display: flex;
            height: 50px;
        }
        
        .number-btn {
            width: 50px;
            background: var(--dark);
            border: 3px solid var(--accent);
            font-size: 1.5rem;
            color: var(--accent);
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'VT323', monospace;
        }
        
        .number-btn:first-child {
            border-right: none;
        }
        
        .number-btn:last-child {
            border-left: none;
        }
        
        .number-btn:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }
        
        #photoCount {
            width: 100%;
            border: 3px solid var(--accent);
            text-align: center;
            font-size: 1.5rem;
            color: var(--accent);
            background: var(--dark);
            font-family: 'VT323', monospace;
        }
        
        .color-control {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        #frameColor {
            width: 50px;
            height: 50px;
            border: none;
            border: 3px solid var(--accent);
            cursor: pointer;
            background: var(--dark);
        }
        
        #colorValue {
            font-size: 1.4rem;
            color: var(--accent);
        }
        
        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .filter-btn {
            padding: 12px 20px;
            background: var(--dark);
            border: 3px solid var(--accent);
            font-size: 1.2rem;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'VT323', monospace;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 0 rgba(0, 0, 0, 0.3);
        }
        
        #startCapture {
            height: 70px;
            background: var(--primary);
            color: white;
            border: none;
            border: 4px solid var(--accent);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3);
            font-family: 'Press Start 2P', cursive;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        #startCapture:hover {
            transform: translateY(-3px);
            background: #ff5252;
            box-shadow: 0 11px 0 rgba(0, 0, 0, 0.3);
        }
        
        #startCapture:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3);
        }
        
        canvas {
            display: none;
        }
        
        .photo-strip-container {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        #photoStrip {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            min-height: 300px;
        }
        
        @media (max-width: 600px) {
            #photoStrip {
                grid-template-columns: 1fr;
            }
        }
        
        .photo-slot {
            background: #0d3d44;
            border: 4px solid var(--accent);
            aspect-ratio: 3/4;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: var(--accent);
            transition: all 0.3s;
            overflow: hidden;
            position: relative;
            box-shadow: 5px 5px 0 rgba(0, 0, 0, 0.3);
        }
        
        .photo-slot i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--accent);
        }
        
        .photo-slot.loading i {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .photo-item {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.3s;
            position: relative;
            z-index: 1;
            image-rendering: pixelated;
        }
        
        .photo-frame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 10px solid var(--frame);
            z-index: 2;
            pointer-events: none;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.5);
        }
        
        .photo-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
            color: white;
            padding: 15px 10px 8px;
            font-size: 1rem;
            text-align: center;
            z-index: 3;
            transform: translateY(100%);
            transition: transform 0.3s;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
        }
        
        .photo-slot:hover .photo-overlay {
            transform: translateY(0);
        }
        
        .photo-label {
            position: absolute;
            bottom: 10px;
            left: 0;
            right: 0;
            text-align: center;
            color: var(--accent);
            font-size: 1.2rem;
            z-index: 2;
            background: rgba(26, 83, 92, 0.8);
            padding: 5px;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 600px) {
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }
        
        .action-btn {
            height: 60px;
            border-radius: 0;
            font-size: 1.2rem;
            font-weight: normal;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            border: 4px solid var(--accent);
            box-shadow: 0 5px 0 rgba(0, 0, 0, 0.3);
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9rem;
            text-transform: uppercase;
        }
        
        .action-btn i {
            font-size: 1.2rem;
        }
        
        #downloadStrip {
            background: var(--secondary);
            color: var(--dark);
            text-decoration: none;
        }
        
        #downloadStrip:hover {
            transform: translateY(-3px);
            background: #3abab3;
            box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3);
        }
        
        #shareBtn {
            background: var(--primary);
            color: white;
        }
        
        #shareBtn:hover {
            transform: translateY(-3px);
            background: #ff5252;
            box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3);
        }
        
        #resetBtn {
            background: var(--accent);
            color: var(--dark);
        }
        
        #resetBtn:hover {
            transform: translateY(-3px);
            background: #ffde3a;
            box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3);
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 25px;
        }
        
        @media (max-width: 600px) {
            .features {
                grid-template-columns: 1fr;
            }
        }
        
        .feature-card {
            background: rgba(26, 83, 92, 0.6);
            border-radius: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            border: 3px solid var(--accent);
            transition: all 0.3s;
            box-shadow: 5px 5px 0 rgba(0, 0, 0, 0.3);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            background: rgba(26, 83, 92, 0.8);
            box-shadow: 8px 8px 0 rgba(0, 0, 0, 0.3);
        }
        
        .feature-icon {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            border: 3px solid var(--accent);
        }
        
        .feature-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9rem;
            color: var(--accent);
        }
        
        .feature-desc {
            font-size: 1.2rem;
            color: #F7FFF7;
            line-height: 1.4;
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            color: var(--accent);
            font-size: 1.2rem;
            width: 100%;
            max-width: 600px;
            margin-top: 20px;
            border-top: 4px solid var(--accent);
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
        }
        
        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }
        
        .social-links a {
            width: 50px;
            height: 50px;
            border-radius: 0;
            background: var(--dark);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            transition: all 0.3s;
            text-decoration: none;
            border: 3px solid var(--accent);
            box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.3);
        }
        
        .social-links a:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 5px 5px 0 rgba(0, 0, 0, 0.3);
        }
        
        /* Pixel art characters */
        .pixel-art {
            position: absolute;
            z-index: 1;
            image-rendering: pixelated;
        }
        
        .pixel-1 {
            top: 10%;
            left: 5%;
            width: 80px;
            animation: float 4s ease-in-out infinite;
        }
        
        .pixel-2 {
            bottom: 10%;
            right: 5%;
            width: 100px;
            animation: float 5s ease-in-out infinite 0.5s;
        }
        
        /* Floating animation */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }
        
        .pixel-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(255, 230, 109, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 230, 109, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 0;
        }
    </style>
</head>
<body>
    <div class="pixel-grid"></div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-camera"></i> PIXEL PHOTO BOOTH</h1>
            <p class="subtitle">CAPTURE YOUR PIXEL PERFECT MOMENTS!</p>
        </header>
        
        <div class="main-content">
            <div class="panel">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%23FF6B6B' x='20' y='20' width='60' height='60'/%3E%3Ccircle fill='%23FFE66D' cx='50' cy='40' r='10'/%3E%3Cpath fill='%231A535C' d='M30,70 Q50,90 70,70'/%3E%3C/svg%3E" alt="Pixel character" class="pixel-art pixel-1">
                <h2 class="panel-title"><i class="fas fa-camera"></i> CAMERA & SETTINGS</h2>
                
                <div class="camera-container">
                    <video id="camera" autoplay></video>
                    <div id="countdown">3</div>
                </div>
                
                <div class="controls-grid">
                    <div class="control-group">
                        <label class="control-label"><i class="fas fa-images"></i> PHOTOS COUNT</label>
                        <div class="number-control">
                            <button id="decreaseCount" class="number-btn">-</button>
                            <input type="number" id="photoCount" min="1" max="5" value="3">
                            <button id="increaseCount" class="number-btn">+</button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label"><i class="fas fa-palette"></i> FRAME COLOR</label>
                        <div class="color-control">
                            <input type="color" id="frameColor" value="#FF6B6B">
                            <span id="colorValue">#FF6B6B</span>
                        </div>
                    </div>
                </div>
                
                <div class="control-group">
                    <label class="control-label"><i class="fas fa-magic"></i> PHOTO FILTERS</label>
                    <div class="filters">
                        <button class="filter-btn active" data-filter="normal">
                            <i class="fas fa-sun"></i> NORMAL
                        </button>
                        <button class="filter-btn" data-filter="grayscale">
                            <i class="fas fa-moon"></i> GRAYSCALE
                        </button>
                        <button class="filter-btn" data-filter="sepia">
                            <i class="fas fa-feather"></i> SEPIA
                        </button>
                        <button class="filter-btn" data-filter="vintage">
                            <i class="fas fa-camera-retro"></i> VINTAGE
                        </button>
                    </div>
                </div>
                
                <button id="startCapture">
                    <i class="fas fa-play"></i> START CAPTURE
                </button>
                
                <canvas id="canvas"></canvas>
            </div>
            
            <div class="panel">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%234ECDC4' x='20' y='20' width='60' height='60'/%3E%3Ccircle fill='%23FFE66D' cx='40' cy='40' r='8'/%3E%3Ccircle fill='%23FFE66D' cx='60' cy='40' r='8'/%3E%3Cpath fill='none' stroke='%23FFE66D' stroke-width='4' d='M35,65 Q50,75 65,65'/%3E%3C/svg%3E" alt="Pixel character" class="pixel-art pixel-2">
                <h2 class="panel-title"><i class="fas fa-images"></i> YOUR PHOTO STRIP</h2>
                
                <div class="photo-strip-container">
                    <div id="photoStrip">
                        <div class="photo-slot">
                            <i class="fas fa-camera"></i>
                            <span class="photo-label">PHOTO 1</span>
                        </div>
                        <div class="photo-slot">
                            <i class="fas fa-camera"></i>
                            <span class="photo-label">PHOTO 2</span>
                        </div>
                        <div class="photo-slot">
                            <i class="fas fa-camera"></i>
                            <span class="photo-label">PHOTO 3</span>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <a id="downloadStrip" class="action-btn" download="pixel_photobooth.png">
                            <i class="fas fa-download"></i> DOWNLOAD
                        </a>
                        <button id="shareBtn" class="action-btn">
                            <i class="fas fa-share-alt"></i> SHARE
                        </button>
                        <button id="resetBtn" class="action-btn">
                            <i class="fas fa-redo"></i> RESET
                        </button>
                    </div>
                </div>
                
                <div class="features">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <h3 class="feature-title">PIXEL ART</h3>
                        <p class="feature-desc">Retro pixel style for nostalgic fun!</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <h3 class="feature-title">MOBILE FRIENDLY</h3>
                        <p class="feature-desc">Works perfectly on all devices!</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-paint-brush"></i>
                        </div>
                        <h3 class="feature-title">COLORFUL</h3>
                        <p class="feature-desc">Bright, cheerful pixel colors!</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-grin-stars"></i>
                        </div>
                        <h3 class="feature-title">FUN EFFECTS</h3>
                        <p class="feature-desc">Special pixel filters & frames!</p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 PIXEL PHOTO BOOTH</p>
            <p>CREATED WITH <i class="fas fa-heart"></i> BY EVAN</p>
            <div class="social-links">
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-discord"></i></a>
                <a href="#"><i class="fab fa-github"></i></a>
            </div>
        </footer>
    </div>

    <script>
        // Elements
        const video = document.getElementById('camera');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const startCaptureButton = document.getElementById('startCapture');
        const photoCountInput = document.getElementById('photoCount');
        const frameColorInput = document.getElementById('frameColor');
        const colorValue = document.getElementById('colorValue');
        const photoStrip = document.getElementById('photoStrip');
        const downloadButton = document.getElementById('downloadStrip');
        const shareBtn = document.getElementById('shareBtn');
        const resetBtn = document.getElementById('resetBtn');
        const countdownEl = document.getElementById('countdown');
        const decreaseBtn = document.getElementById('decreaseCount');
        const increaseBtn = document.getElementById('increaseCount');
        const filterButtons = document.querySelectorAll('.filter-btn');
        
        // Variables
        let currentFilter = 'normal';
        let isCapturing = false;
        let photoStripDataURL = null;
        
        // Initialize camera
        function initCamera() {
            navigator.mediaDevices.getUserMedia({ video: true, audio: false })
                .then(stream => {
                    video.srcObject = stream;
                })
                .catch(err => {
                    console.error(`Camera error: ${err}`);
                    photoStrip.innerHTML = `
                        <div class="photo-slot" style="grid-column: 1 / -1; text-align: center; padding: 30px;">
                            <i class="fas fa-exclamation-triangle" style="color: #FF6B6B; font-size: 3rem;"></i>
                            <h3 style="margin-top: 20px; color: #F7FFF7;">CAMERA ACCESS REQUIRED</h3>
                            <p style="margin-top: 10px; color: #4ECDC4;">Please allow camera access to use this photo booth.</p>
                        </div>
                    `;
                });
        }
        
        // Update color value display
        frameColorInput.addEventListener('input', () => {
            colorValue.textContent = frameColorInput.value;
            document.documentElement.style.setProperty('--frame', frameColorInput.value);
        });
        
        // Photo count controls
        decreaseBtn.addEventListener('click', () => {
            if (photoCountInput.value > 1) {
                photoCountInput.value = parseInt(photoCountInput.value) - 1;
                updatePhotoSlots();
            }
        });
        
        increaseBtn.addEventListener('click', () => {
            if (photoCountInput.value < 5) {
                photoCountInput.value = parseInt(photoCountInput.value) + 1;
                updatePhotoSlots();
            }
        });
        
        photoCountInput.addEventListener('change', () => {
            let value = parseInt(photoCountInput.value);
            if (value < 1) value = 1;
            if (value > 5) value = 5;
            photoCountInput.value = value;
            updatePhotoSlots();
        });
        
        function updatePhotoSlots() {
            const count = parseInt(photoCountInput.value);
            let slotsHTML = '';
            
            for (let i = 0; i < count; i++) {
                slotsHTML += `
                    <div class="photo-slot">
                        <i class="fas fa-camera"></i>
                        <span class="photo-label">PHOTO ${i+1}</span>
                    </div>
                `;
            }
            
            photoStrip.innerHTML = slotsHTML;
        }
        
        // Filter selection
        filterButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                filterButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
            });
        });
        
        // Start capture process
        startCaptureButton.addEventListener('click', () => {
            if (isCapturing) return;
            
            const numPhotos = parseInt(photoCountInput.value);
            const frameColor = frameColorInput.value;
            
            // Update photo slots to show loading
            const slots = photoStrip.querySelectorAll('.photo-slot');
            slots.forEach((slot, index) => {
                slot.innerHTML = `
                    <i class="fas fa-spinner loading"></i>
                    <span class="photo-label">CAPTURING PHOTO ${index+1}</span>
                `;
            });
            
            startCaptureButton.disabled = true;
            startCaptureButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> CAPTURING...';
            
            capturePhotos(numPhotos, frameColor);
        });
        
        // Main photo capture function
        function capturePhotos(numPhotos, frameColor) {
            isCapturing = true;
            const images = [];
            let currentPhoto = 0;
            
            function captureNextPhoto() {
                if (currentPhoto < numPhotos) {
                    // Show countdown
                    let countdown = 3;
                    countdownEl.textContent = countdown;
                    countdownEl.classList.add('active');
                    
                    const countdownInterval = setInterval(() => {
                        countdown--;
                        countdownEl.textContent = countdown;
                        
                        if (countdown <= 0) {
                            clearInterval(countdownInterval);
                            countdownEl.classList.remove('active');
                            
                            // Capture the photo after a slight delay
                            setTimeout(() => {
                                canvas.width = video.videoWidth;
                                canvas.height = video.videoHeight;
                                
                                // Apply horizontal flip
                                ctx.save();
                                ctx.scale(-1, 1);
                                ctx.drawImage(video, -canvas.width, 0, canvas.width, canvas.height);
                                ctx.restore();
                                
                                // Apply filter
                                applyFilter(ctx, currentFilter);
                                
                                // Create image
                                const img = document.createElement('img');
                                img.src = canvas.toDataURL('image/png');
                                img.classList.add('photo-item');
                                
                                // Create frame element
                                const frame = document.createElement('div');
                                frame.classList.add('photo-frame');
                                
                                // Create overlay
                                const overlay = document.createElement('div');
                                overlay.classList.add('photo-overlay');
                                overlay.innerHTML = `<i class="fas fa-gamepad"></i> PIXEL PHOTO BOOTH`;
                                
                                // Create label
                                const label = document.createElement('span');
                                label.classList.add('photo-label');
                                label.textContent = `PHOTO ${currentPhoto+1}`;
                                
                                // Add to photo strip
                                const slot = photoStrip.children[currentPhoto];
                                slot.innerHTML = '';
                                slot.appendChild(img);
                                slot.appendChild(frame);
                                slot.appendChild(overlay);
                                slot.appendChild(label);
                                
                                images.push(img.src);
                                currentPhoto++;
                                
                                // Capture next photo
                                setTimeout(captureNextPhoto, 1000);
                            }, 300);
                        }
                    }, 1000);
                } else {
                    // Create photo strip
                    createPhotoStrip(images, frameColor);
                    isCapturing = false;
                    startCaptureButton.disabled = false;
                    startCaptureButton.innerHTML = '<i class="fas fa-play"></i> START CAPTURE';
                }
            }
            
            captureNextPhoto();
        }
        
        // Apply filter to the image
        function applyFilter(context, filter) {
            context.save();
            
            switch(filter) {
                case 'grayscale':
                    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;
                    for (let i = 0; i < data.length; i += 4) {
                        const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                        data[i] = avg;
                        data[i + 1] = avg;
                        data[i + 2] = avg;
                    }
                    context.putImageData(imageData, 0, 0);
                    break;
                case 'sepia':
                    context.filter = 'sepia(100%)';
                    context.drawImage(canvas, 0, 0);
                    break;
                case 'vintage':
                    // Pixelate effect for vintage
                    const size = 10;
                    const w = canvas.width;
                    const h = canvas.height;
                    
                    for (let y = 0; y < h; y += size) {
                        for (let x = 0; x < w; x += size) {
                            const pixelData = context.getImageData(x, y, size, size).data;
                            let r = 0, g = 0, b = 0;
                            
                            for (let i = 0; i < pixelData.length; i += 4) {
                                r += pixelData[i];
                                g += pixelData[i + 1];
                                b += pixelData[i + 2];
                            }
                            
                            const count = pixelData.length / 4;
                            r = ~~(r / count);
                            g = ~~(g / count);
                            b = ~~(b / count);
                            
                            context.fillStyle = `rgb(${r}, ${g}, ${b})`;
                            context.fillRect(x, y, size, size);
                        }
                    }
                    break;
            }
            
            context.restore();
        }
        
        // Create photo strip
        function createPhotoStrip(images, frameColor) {
            const stripCanvas = document.createElement('canvas');
            const stripCtx = stripCanvas.getContext('2d');
            const imgWidth = canvas.width;
            const imgHeight = canvas.height;
            const padding = 40;
            const spacing = 20;
            
            const numPhotos = images.length;
            const stripHeight = (imgHeight * numPhotos) + (spacing * (numPhotos - 1)) + (padding * 2);
            stripCanvas.width = imgWidth + (padding * 2);
            stripCanvas.height = stripHeight;
            
            // Draw background
            stripCtx.fillStyle = '#1A535C';
            stripCtx.fillRect(0, 0, stripCanvas.width, stripHeight);
            
            // Draw pixel pattern
            for (let y = 0; y < stripHeight; y += 10) {
                for (let x = 0; x < stripCanvas.width; x += 10) {
                    if ((x / 10 + y / 10) % 2 === 0) {
                        stripCtx.fillStyle = 'rgba(255, 230, 109, 0.1)';
                        stripCtx.fillRect(x, y, 10, 10);
                    }
                }
            }
            
            // Draw images
            let loadedCount = 0;
            images.forEach((src, index) => {
                const img = new Image();
                img.src = src;
                img.onload = () => {
                    const yPos = padding + (index * (imgHeight + spacing));
                    
                    // Draw pixelated background for each photo
                    stripCtx.fillStyle = frameColor;
                    stripCtx.fillRect(padding - 10, yPos - 10, imgWidth + 20, imgHeight + 20);
                    
                    stripCtx.drawImage(img, padding, yPos, imgWidth, imgHeight);
                    
                    // Draw pixel border
                    stripCtx.strokeStyle = '#FFE66D';
                    stripCtx.lineWidth = 5;
                    stripCtx.strokeRect(padding, yPos, imgWidth, imgHeight);
                    
                    loadedCount++;
                    
                    if (loadedCount === numPhotos) {
                        // Add footer
                        stripCtx.fillStyle = frameColor;
                        stripCtx.fillRect(0, stripHeight - 50, stripCanvas.width, 50);
                        
                        // Add footer text
                        stripCtx.font = 'bold 18px "Press Start 2P", cursive';
                        stripCtx.fillStyle = '#1A535C';
                        stripCtx.textAlign = 'center';
                        stripCtx.fillText('PIXEL PHOTO BOOTH • ' + new Date().toLocaleDateString(), stripCanvas.width / 2, stripHeight - 20);
                        
                        // Add header text
                        stripCtx.font = 'bold 24px "Press Start 2P", cursive';
                        stripCtx.fillStyle = '#FFE66D';
                        stripCtx.textAlign = 'center';
                        stripCtx.fillText('YOUR PIXEL MEMORIES', stripCanvas.width / 2, 30);
                        
                        // Set download URL
                        photoStripDataURL = stripCanvas.toDataURL('image/png');
                        downloadButton.href = photoStripDataURL;
                    }
                };
            });
        }
        
        // Share photo strip
        shareBtn.addEventListener('click', () => {
            if (!photoStripDataURL) {
                alert('Please capture photos first!');
                return;
            }
            
            // Convert data URL to blob
            fetch(photoStripDataURL)
                .then(res => res.blob())
                .then(blob => {
                    if (navigator.share) {
                        navigator.share({
                            title: 'My Pixel Photo Booth Creation',
                            text: 'Check out my awesome pixel photo strip!',
                            files: [new File([blob], 'pixel_photobooth.png', { type: 'image/png' })]
                        })
                        .catch(console.error);
                    } else {
                        // Fallback for browsers without Web Share API
                        const link = document.createElement('a');
                        link.href = photoStripDataURL;
                        link.download = 'pixel_photobooth.png';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                    }
                });
        });
        
        // Reset photo strip
        resetBtn.addEventListener('click', () => {
            photoStripDataURL = null;
            downloadButton.removeAttribute('href');
            updatePhotoSlots();
        });
        
        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            initCamera();
            colorValue.textContent = frameColorInput.value;
            document.documentElement.style.setProperty('--frame', frameColorInput.value);
        });
    </script>
</body>
</html>